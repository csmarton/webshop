{% extends "FrontendLayoutBundle:Default:layout.html.twig" %}

{% block title%} WebShop - Kezdőlap {% endblock %}
{% block bodyClass %}class="index_page"{% endblock%}
 
{% block javascripts %}
	{{ parent() }}
    <script type="text/javascript" src="{{ asset('bundles/frontendproduct/js/Product.js') }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/frontendcart/js/Cart.js') }}"></script>
    <script type="text/javascript">
            $(document).ready(function(){
                Product.init();
                Cart.init();
            });
    </script>
{% endblock %}
 
{% block main %}
    <div class="main">
        {% block leftSide %}                        
            {{parent()}}
        {% endblock %}        
        <div class="container">
            <h2 class="page-title">Termékek</h2>
       
            <table class="cart_table">
                <thead>
                    <tr>
                        <th scope="col">Terméknév</th>                        
                        <th scope="col">Leírás</th>
                        <th scope="col">Mennyiség</th>
                        <th scope="col">Ár(Ft)</th>
                        <th scope="col">Kijelölés törlése</th>
                    </tr>
                </thead>
                <tbody>
                    {% set cartCount = 0 %}
                    {% set cartPrice = 0 %}
                    {% for productWithCount in productsWithCount %}
                         {% set cartCount = cartCount + productWithCount[1] %}
                         {% set cartPrice = cartPrice + productWithCount[0].getPrice() %}
                        <tr>
                            <td>{{ productWithCount[0].getName() }}</td>                            
                            <td></td>
                            <td><input type="number" value="{{ productWithCount[1] }}"/></td>
                            <td>{{ productWithCount[1]*productWithCount[0].getPrice() }}</td>
                            <td><input type="checkbox" name="deleteProductFromCart" value="{{productWithCount[0].getId()}}"/></td>
                        </tr>
                    {% endfor %}
                    <tfoot>
                       <tr>
                         <td>Összegezve</td>
                         <td>-</td>
                         <td>{{ cartCount }}</td>
                         <td>{{ cartPrice }}</td>
                         <td><input type="checkbox" name="deleteProductFromCart" value="all"/></td>
                       </tr>
                       <tr >
                            <td colspan="5">   
                                {% if (is_granted("IS_AUTHENTICATED_REMEMBERED")) %}
                                    {% set isLoggedIn = 1 %}
                                {% else %}
                                    {% set isLoggedIn = 0 %}
                                {% endif %}    
                                <a href="{{path('frontend_cart_order')}}" class="menu_btn ok_btn" id="order-button" isLoggedIn = {{isLoggedIn}}>Megrendel</a>
                                <a href="" class="menu_btn ok_btn" id="cart_update_btn">Kosár frissítése</a>
                            </td>
                       </tr>
                     </tfoot>
                    
                </tbody>
            </table>
        
        </div>
    </div>    
{% endblock %}
                        